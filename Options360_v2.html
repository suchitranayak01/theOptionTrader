<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>TheOptionTrader - Options 360</title>
  <link rel="stylesheet" href="style.css?v=20260111" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root { --bg:#050b13; --panel:#0b1220; --card:#0f172a; --border:#1e293b; --text:#e6eef8; --muted:#94a3b8; --accent:#3b82f6; --good:#22c55e; --bad:#ef4444; }
    * { box-sizing: border-box; }
    body { margin:0; padding:20px; background:var(--bg); color:var(--text); font-family:'Helvetica Neue', Helvetica, Arial, sans-serif; }
    a { color:inherit; text-decoration:none; }
    header { display:flex; justify-content:space-between; align-items:center; margin-bottom:16px; }
    .brand { display:flex; align-items:center; gap:12px; font-weight:800; font-size:22px; letter-spacing:0.5px; }
    .pill { display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; border:1px solid var(--border); background:rgba(59,130,246,0.12); font-size:12px; }
    .grid { display:grid; gap:12px; }
    .card { background:var(--card); border:1px solid var(--border); border-radius:12px; padding:14px; }
    .row { display:flex; gap:12px; align-items:center; }
    .tickers { grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
    .ticker { padding:14px; background:var(--panel); border:1px solid var(--border); border-radius:12px; }
    .t-name { color:var(--muted); font-size:14px; }
    .t-value { font-size:26px; font-weight:700; }
    .t-change { font-weight:600; }
    .pos { color:var(--good); } .neg { color:var(--bad); }
    .controls { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }
    label { display:flex; flex-direction:column; gap:6px; font-size:13px; color:var(--muted); }
    select { padding:10px; border-radius:8px; border:1px solid var(--border); background:#0b1220; color:var(--text); }
    .indicators { grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
    .indicator h4 { margin:0 0 6px 0; font-size:14px; color:var(--muted); letter-spacing:0.4px; }
    .indicator .val { font-size:28px; font-weight:700; }
    .indicator .sub { font-size:13px; font-weight:600; }
    .status { display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:8px; border:1px solid var(--border); font-size:12px; color:var(--muted); margin-top:6px; }
    .chart-wrap { margin-top:10px; background:var(--panel); border:1px solid var(--border); border-radius:12px; padding:12px; min-height:50vh; }
    .chart-wrap canvas { height:45vh !important; }
    .chart-toggle { display:flex; gap:16px; align-items:center; margin-bottom:10px; }
    .subtitle { color:var(--muted); font-size:13px; margin:4px 0 0; }
    .footer { color:var(--muted); font-size:12px; margin-top:16px; }
    .badge-green { color:var(--good); } .badge-red { color:var(--bad); }
    @media(max-width:768px){ body{padding:12px;} header{flex-direction:column; align-items:flex-start;} }
  </style>
</head>
<body>
  <header>
    <div>
      <div class="brand">TheOptionTrader · Options 360</div>
      <div class="subtitle">Live overview for Nifty, Sensex, Bank Nifty</div>
    </div>
    <div class="row">
      <span class="pill" id="livePill"><span class="dot" style="width:8px;height:8px;border-radius:50%;background:var(--good);"></span>Live</span>
      <a class="pill" href="login.html" id="loginLink">Login</a>
    </div>
  </header>

  <section class="grid tickers">
    <div class="ticker"><div class="t-name">NIFTY 50</div><div class="t-value" id="niftyVal">--</div><div class="t-change" id="niftyChg">--</div></div>
    <div class="ticker"><div class="t-name">SENSEX</div><div class="t-value" id="sensexVal">--</div><div class="t-change" id="sensexChg">--</div></div>
    <div class="ticker"><div class="t-name">BANK NIFTY</div><div class="t-value" id="bankVal">--</div><div class="t-change" id="bankChg">--</div></div>
  </section>

  <section class="card">
    <div class="grid controls">
      <label>Market
        <select id="marketSelect">
          <option value="equity">Equity</option>
          <option value="commodity">Commodity</option>
          <option value="currency">Currency</option>
        </select>
      </label>
      <label>Symbol
        <select id="symbolSelect"></select>
      </label>
      <label>Expiry Date
        <select id="expirySelect"></select>
      </label>
    </div>
  </section>

  <section class="grid indicators">
    <div class="card indicator"><h4>Implied Volatility (IV)</h4><div class="val" id="ivVal">--</div><div class="sub" id="ivChg">--</div><div class="status" id="ivStatus">Monitoring…</div></div>
    <div class="card indicator"><h4>Put/Call Ratio (PCR)</h4><div class="val" id="pcrVal">--</div><div class="sub" id="pcrChg">--</div><div class="status" id="pcrStatus">Neutral</div></div>
    <div class="card indicator"><h4>VIX</h4><div class="val" id="vixVal">--</div><div class="sub" id="vixChg">--</div><div class="status" id="vixStatus">Calm</div></div>
    <div class="card indicator"><h4>Straddle Premium</h4><div class="val" id="straddleVal">--</div><div class="sub" id="straddleSub">--</div><div class="status" id="straddleStatus">Monitoring…</div></div>
    <div class="card indicator"><h4>ATM Call Premium</h4><div class="val" id="callVal">--</div><div class="sub" id="callSub">--</div><div class="status">ATM Call</div></div>
    <div class="card indicator"><h4>ATM Put Premium</h4><div class="val" id="putVal">--</div><div class="sub" id="putSub">--</div><div class="status">ATM Put</div></div>
    <div class="card indicator"><h4>Last Updated</h4><div class="val" id="lastUpdated">--:--:--</div><div class="sub">Auto-refreshing every 5s</div><div class="status">System Clock</div></div>
  </section>

  <section class="card chart-wrap">
    <div class="row" style="justify-content:space-between; align-items:center;">
      <div><div style="font-weight:700;">Straddle Premium Chart</div><div class="subtitle">Live line or candle view</div></div>
      <div class="chart-toggle">
        <label><input type="radio" name="chartMode" value="live" checked /> Live</label>
        <label><input type="radio" name="chartMode" value="candle" /> Candle</label>
      </div>
    </div>
    <canvas id="straddleChart" height="140"></canvas>
  </section>

  <div class="footer">Demo only. Not trading advice.</div>

  <script>
    const symbols = { equity: ['Nifty','Sensex','Bank Nifty'], commodity: ['Gold','Goldm','Silver','Silverm'], currency: ['USDINR'] };
    const state = { dayLowStraddle:null, chart:null, chartMode:'live', alertsEnabled:true };
    const marketSelect = document.getElementById('marketSelect');
    const symbolSelect = document.getElementById('symbolSelect');
    const expirySelect = document.getElementById('expirySelect');
    function populateSymbols(){ const m=marketSelect.value; symbolSelect.innerHTML = symbols[m].map(s=>`<option value="${s}">${s}</option>`).join(''); }
    function populateExpiry(){ const t=new Date(); const opts=[]; for(let i=1;i<=4;i++){ const d=new Date(t.getTime()+i*7*24*3600*1000); opts.push(d.toISOString().split('T')[0]); } expirySelect.innerHTML=opts.map(o=>`<option value="${o}">${o}</option>`).join(''); }
    marketSelect.addEventListener('change', populateSymbols); populateSymbols(); populateExpiry();
    function playBeep(f=880,d=180){ const ctx=new (window.AudioContext||window.webkitAudioContext)(); const osc=ctx.createOscillator(); const g=ctx.createGain(); osc.frequency.value=f; osc.type='sine'; g.gain.setValueAtTime(0.15,ctx.currentTime); g.gain.exponentialRampToValueAtTime(0.0001,ctx.currentTime+d/1000); osc.connect(g).connect(ctx.destination); osc.start(); osc.stop(ctx.currentTime+d/1000); }
    const ctxChart=document.getElementById('straddleChart').getContext('2d');
    state.chart=new Chart(ctxChart,{ type:'line', data:{ labels:[], datasets:[{ label:'Straddle Premium', data:[], borderColor:'#3b82f6', backgroundColor:'rgba(59,130,246,0.2)', tension:0.2 }]}, options:{ responsive:true, maintainAspectRatio:false, animation:false, plugins:{legend:{display:false}}, scales:{x:{display:false, grid:{color:'rgba(148,163,184,0.2)'}}, y:{ticks:{color:'#cbd5e1'}, grid:{color:'rgba(148,163,184,0.2)'}} } }});
    document.querySelectorAll('input[name="chartMode"]').forEach(r=>r.addEventListener('change',e=>{ state.chartMode=e.target.value; const ds=state.chart.data.datasets[0]; if(state.chartMode==='candle'){ ds.type='bar'; ds.backgroundColor='rgba(234,179,8,0.25)'; ds.borderColor='#eab308'; } else { ds.type='line'; ds.backgroundColor='rgba(59,130,246,0.2)'; ds.borderColor='#3b82f6'; } state.chart.update(); }));
    function randBetween(min,max){ return min+Math.random()*(max-min); }
    function generateSnapshot(){ return { nifty:{price:randBetween(21500,22000), chg:randBetween(-1.2,1.2)}, sensex:{price:randBetween(72000,74000), chg:randBetween(-1.0,1.0)}, bank:{price:randBetween(45500,46500), chg:randBetween(-1.5,1.5)}, iv:{val:randBetween(12,35), chg:randBetween(-12,14)}, pcr:{val:randBetween(0.7,1.3), chg:randBetween(-0.1,0.1)}, vix:{val:randBetween(12,25), chg:randBetween(-12,14)}, atmCall:randBetween(80,180), atmPut:randBetween(70,170) }; }
    function setTicker(idVal,idChg,obj){ document.getElementById(idVal).textContent=obj.price.toFixed(2); const el=document.getElementById(idChg); el.textContent=`${obj.chg>=0?'+':''}${obj.chg.toFixed(2)}%`; el.className='t-change '+(obj.chg>=0?'pos':'neg'); }
    function updateIndicators(){ const snap=generateSnapshot(); setTicker('niftyVal','niftyChg',snap.nifty); setTicker('sensexVal','sensexChg',snap.sensex); setTicker('bankVal','bankChg',snap.bank);
      document.getElementById('ivVal').textContent=snap.iv.val.toFixed(2)+'%'; const ivChg=snap.iv.chg; const ivChgEl=document.getElementById('ivChg'); ivChgEl.textContent=`${ivChg>=0?'+':''}${ivChg.toFixed(2)}%`; ivChgEl.className='sub '+(Math.abs(ivChg)>10?'badge-red':'badge-green'); document.getElementById('ivStatus').textContent=Math.abs(ivChg)>10?'High IV move':'Stable'; if(Math.abs(ivChg)>10) playBeep(1100,180);
      document.getElementById('pcrVal').textContent=snap.pcr.val.toFixed(2); const pcrChg=snap.pcr.chg; const pcrEl=document.getElementById('pcrChg'); pcrEl.textContent=`${pcrChg>=0?'+':''}${pcrChg.toFixed(2)}`; pcrEl.className='sub '+(pcrChg>=0?'badge-green':''); document.getElementById('pcrStatus').textContent=snap.pcr.val>1.1?'Bullish skew':snap.pcr.val<0.9?'Bearish skew':'Neutral';
      document.getElementById('vixVal').textContent=snap.vix.val.toFixed(2); const vixChg=snap.vix.chg; const vixEl=document.getElementById('vixChg'); vixEl.textContent=`${vixChg>=0?'+':''}${vixChg.toFixed(2)}%`; vixEl.className='sub '+(Math.abs(vixChg)>10?'badge-red':'badge-green'); document.getElementById('vixStatus').textContent=Math.abs(vixChg)>10?'Vol spike':'Calm'; if(Math.abs(vixChg)>10) playBeep(900,200);
      document.getElementById('callVal').textContent=snap.atmCall.toFixed(2); document.getElementById('putVal').textContent=snap.atmPut.toFixed(2); document.getElementById('callSub').textContent='ATM Call premium'; document.getElementById('putSub').textContent='ATM Put premium'; const straddle=snap.atmCall+snap.atmPut; if(state.dayLowStraddle===null) state.dayLowStraddle=straddle; if(straddle<state.dayLowStraddle) state.dayLowStraddle=straddle; const fromLowPct=((straddle-state.dayLowStraddle)/state.dayLowStraddle)*100; document.getElementById('straddleVal').textContent=straddle.toFixed(2); const straddleSub=document.getElementById('straddleSub'); straddleSub.textContent=`From day low: ${fromLowPct>=0?'+':''}${fromLowPct.toFixed(2)}%`; const straddleStatus=document.getElementById('straddleStatus'); straddleStatus.textContent='Day low: '+state.dayLowStraddle.toFixed(2);
      if(fromLowPct>20){ straddleSub.className='sub badge-red'; state.chart.data.datasets[0].borderColor='#ef4444'; state.chart.data.datasets[0].backgroundColor='rgba(239,68,68,0.2)'; playBeep(700,220); } else if(fromLowPct>10){ straddleSub.className='sub badge-red'; state.chart.data.datasets[0].borderColor='#f59e0b'; state.chart.data.datasets[0].backgroundColor='rgba(245,158,11,0.2)'; playBeep(800,180); } else { straddleSub.className='sub badge-green'; state.chart.data.datasets[0].borderColor='#3b82f6'; state.chart.data.datasets[0].backgroundColor=state.chartMode==='candle'?'rgba(234,179,8,0.25)':'rgba(59,130,246,0.2)'; }
      const now=new Date(); state.chart.data.labels.push(now.toLocaleTimeString()); state.chart.data.datasets[0].data.push(straddle.toFixed(2)); if(state.chart.data.labels.length>40){ state.chart.data.labels.shift(); state.chart.data.datasets[0].data.shift(); } state.chart.update(); document.getElementById('lastUpdated').textContent=now.toLocaleTimeString(); }
    updateIndicators(); setInterval(updateIndicators,5000);
    window.addEventListener('DOMContentLoaded',()=>{ if(window.AUTH && AUTH.initializeProfileDropdown){ AUTH.initializeProfileDropdown(); } });
  </script>
  <script src="auth.js?v=20260111"></script>
</body>
</html>